(this["webpackJsonpdesafio-tmdb-infinitescroll-debounce-redux"]=this["webpackJsonpdesafio-tmdb-infinitescroll-debounce-redux"]||[]).push([[0],{50:function(e,t,a){},75:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),o=a(19),c=a.n(o),s=a(4),i=(a(50),a(14)),l=a(1),d=function(){return Object(l.jsx)("div",{className:"footer",children:Object(l.jsxs)("nav",{className:"footer__nav",children:[Object(l.jsx)("a",{className:"footer__item",href:"https://github.com/fpontef",rel:"noopener noreferrer",children:"Github @ fpontef"}),Object(l.jsx)("p",{className:"footer__item",children:"Coded by NandoTech"})]})})},u=a(3),p=function(e){var t=e.error;return Object(l.jsx)("div",{className:"error",children:Object(l.jsxs)("p",{className:"error__text-warning",children:["Ops, ocorreu um erro: ",t.userMessage]})})},g=function(){return Object(l.jsx)("div",{className:"loading",children:"Carregando..."})},j=a(12),v=a.n(j),b=a(22),h=a(38),m=a.n(h).a.create({baseURL:"https://api.themoviedb.org/3"});m.defaults.headers.common.Authorization="Bearer ".concat("eyJhbGciOiJIUzI1NiJ9.eyJhdWQiOiI0ZDYzMzMxOTQ5OWQ3NDEwYWQ0NDRkZjQ4MmM4MjU0ZSIsInN1YiI6IjYwZWEwMTdjMGU2NGFmMDA0NTFkZDY0NiIsInNjb3BlcyI6WyJhcGlfcmVhZCJdLCJ2ZXJzaW9uIjoxfQ.fQsWHRW5LTporrhIun78Qx1vvxIggprPtPxERLLoWtg"),m.defaults.headers.common["Content-Type"]="application/json";var O=m,f="MOVIE_POPULAR_REQUEST",_="MOVIE_POPULAR_SUCCESS",x="MOVIE_POPULAR_FAIL",y="MOVIE_SEARCH_REQUEST",w="MOVIE_SEARCH_SUCCESS",k="MOVIE_SEARCH_FAIL",E="MOVIE_DETAILS_REQUEST",N="MOVIE_DETAILS_SUCCESS",I="MOVIE_DETAILS_FAIL",P=function(e){var t=e.page,a=void 0===t?1:t,r=e.keyword,n=void 0===r?"":r,o=e.language,c=void 0===o?"pt-BR":o;return function(){var e=Object(b.a)(v.a.mark((function e(t){var r,o;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t({type:y}),e.next=4,O.get("/search/movie?query=".concat(n,"&page=").concat(a,"&language=").concat(c));case 4:r=e.sent,o=r.data,t({type:w,payload:{keyword:n,page:o.page,results:o.results,total_pages:o.total_pages}}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),t({type:k,payload:e.t0});case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}()},M=function(){var e=Object(u.f)(),t=Object(u.g)().id,a=Object(s.c)((function(e){return e.movieDetails})),n=a.loading,o=a.error,c=a.cachedDetails[t],i=Object(s.b)();return Object(r.useEffect)((function(){i(function(e){var t=e.movieId,a=e.language,r=void 0===a?"pt-BR":a;return function(){var e=Object(b.a)(v.a.mark((function e(a,n){var o,c;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n().movieDetails.cachedDetails[t]){e.next=14;break}return e.prev=2,a({type:E}),e.next=6,O.get("/movie/".concat(t,"?language=").concat(r));case 6:o=e.sent,c=o.data,a({type:N,payload:{id:c.id,title:c.title,tagline:c.tagline,originalLanguage:c.original_language,originalTitle:c.original_title,overview:c.overview,popularity:c.popularity,backdropPath:c.backdrop_path,posterPath:c.poster_path,releaseDate:c.release_date,genres:c.genres,voteAverage:c.vote_average}}),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(2),a({type:I,payload:e.t0});case 14:case"end":return e.stop()}}),e,null,[[2,11]])})));return function(t,a){return e.apply(this,arguments)}}()}({movieId:t}))}),[i,t]),Object(l.jsxs)(l.Fragment,{children:[Object(l.jsxs)("button",{type:"button",onClick:function(){return e.goBack()},children:["<< "," Voltar..."]}),n?Object(l.jsx)(g,{}):o?Object(l.jsx)(p,{error:o}):c&&Object(l.jsx)("div",{className:"moviedetails",style:{backgroundSize:"cover",backgroundPosition:"center",backgroundImage:"url(https://image.tmdb.org/t/p/original/".concat(c.backdropPath,") ")},children:Object(l.jsxs)("div",{className:"moviedetails__cover",children:[Object(l.jsxs)("div",{className:"moviedetails__header",children:[null!==c.posterPath?Object(l.jsx)("img",{className:"moviedetails__img",src:"https://image.tmdb.org/t/p/w300/".concat(c.posterPath),alt:"Poster do Filme ".concat(c.title)}):Object(l.jsx)("div",{className:"moviedetails__img img-placeholder ",alt:c.title,children:c.title}),Object(l.jsxs)("div",{className:"moviedetails__items",children:[Object(l.jsx)("h1",{className:"moviedetails__title",children:c.title}),Object(l.jsx)("h4",{className:"moviedetails__text",children:c.releaseDate.split("-")[0]}),c.tagline&&Object(l.jsx)("h4",{className:"moviedetails__tagline",children:c.tagline}),Object(l.jsx)("div",{className:"moviedetails__genre",children:c.genres.map((function(e){return Object(l.jsx)("span",{children:e.name},e.id)}))})]})]}),Object(l.jsx)("p",{className:"moviedetails__text",children:c.overview})]})})]})},S=a(11),R="SEARCH_QUERY_SUCCESS",C="SEARCH_QUERY_RESET",D=function(){var e=Object(u.f)(),t=Object(s.b)(),a=Object(r.useState)(""),n=Object(S.a)(a,2),o=n[0],c=n[1],i=Object(s.c)((function(e){return e.searchQuery})).keyword;return Object(r.useEffect)((function(){i&&e.push("/")}),[e,i]),Object(l.jsx)("input",{className:"search__input",type:"search",name:"search",value:o,placeholder:"Digite sua busca",onChange:function(e){e.preventDefault();var a=e.target.value;c(a),t(function(e){return{type:R,payload:e,meta:{debounce:500}}}(a))}})},A=function(){return Object(l.jsxs)("div",{className:"header",children:[Object(l.jsxs)("div",{className:"header__nav",children:[Object(l.jsx)("h1",{className:"header__title",children:"Explore o Mundo do Cinema!"}),Object(l.jsxs)("div",{className:"header__text",children:[Object(l.jsx)("p",{children:"Powered by"}),Object(l.jsx)("img",{className:"header__logo",src:"https://www.themoviedb.org/assets/2/v4/logos/v2/blue_square_2-d537fb228cf3ded904ef09b136fe3fec72548ebc1fea3fbbd1ad9e36364db38b.svg",alt:"The Movie Data Base Logo"})]})]}),Object(l.jsx)("div",{className:"search",children:Object(l.jsx)(D,{})})]})},T=function(e){var t=e.loading,a=e.page,n=void 0===a?1:a,o=e.hasMorePages,c=Object(r.useState)(n),s=Object(S.a)(c,2),i=s[0],l=s[1],d=Object(r.useRef)(null);return[Object(r.useCallback)((function(e){t||(d.current&&d.current.disconnect(),d.current=new IntersectionObserver((function(e){e[0].isIntersecting&&o&&l((function(e){return e+1}))})),e&&d.current.observe(e))}),[o,t]),i]},L=function(e,t){var a=e.poster_path,r=e.title,n=e.id;return Object(l.jsx)("div",{className:"movielist__item",ref:t,children:Object(l.jsx)(i.b,{to:"/detail/".concat(n),children:null!==a?Object(l.jsx)("img",{className:"movielist__poster",src:"https://image.tmdb.org/t/p/w220_and_h330_face/".concat(a),alt:r}):Object(l.jsx)("div",{className:"img-placeholder movielist__poster",alt:r,children:r})})})},Q=Object(r.forwardRef)(L),U=function(e,t){var a=e.movies;return Object(l.jsx)("div",{className:"movielist",children:a.map((function(e,r){return a.length===r+3?Object(l.jsx)(Q,{ref:t,poster_path:e.poster_path,title:e.title,id:e.id},e.id):Object(l.jsx)(Q,{poster_path:e.poster_path,title:e.title,id:e.id},e.id)}))})},V=n.a.forwardRef(U),J=function(){var e=Object(s.b)(),t=Object(s.c)((function(e){return e.moviePopular})),a=t.loading,n=t.error,o=t.movies,c=t.page,i=t.hasMorePages,d=T({loading:a,page:c,hasMorePages:i}),u=Object(S.a)(d,2),j=u[0],h=u[1];return Object(r.useEffect)((function(){e(function(e){var t=e.page,a=void 0===t?1:t,r=e.language,n=void 0===r?"pt-BR":r;return function(){var e=Object(b.a)(v.a.mark((function e(t){var r,o;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t({type:f}),e.next=4,O.get("/movie/popular?page=".concat(a,"&language=").concat(n));case 4:r=e.sent,o=r.data,t({type:_,payload:{page:o.page,results:o.results,total_pages:o.total_pages}}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),t({type:x,payload:e.t0});case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}()}({page:h}))}),[e,h]),Object(l.jsxs)(l.Fragment,{children:[a&&Object(l.jsx)(g,{}),n?Object(l.jsx)(p,{error:n}):o.length?Object(l.jsx)(V,{movies:o,ref:j}):Object(l.jsx)("div",{className:"error__text",children:"Ops, n\xe3o tem nada aqui."})]})},W=function(e){var t=e.keyword,a=Object(s.b)(),n=Object(s.c)((function(e){return e.movieSearch})),o=n.loading,c=n.error,i=n.movies,d=void 0===i?[]:i,u=n.page,j=n.keyword,v=n.hasMorePages,b=T({loading:o,page:u,hasMorePages:v}),h=Object(S.a)(b,2),m=h[0],O=h[1],f=j;return Object(r.useEffect)((function(){a(P(f===t?{page:O,keyword:t}:{page:1,keyword:t}))}),[a,O,t]),Object(l.jsxs)(l.Fragment,{children:[o&&Object(l.jsx)(g,{}),c?Object(l.jsx)(p,{error:c}):d.length?Object(l.jsx)(V,{movies:d,ref:m}):Object(l.jsx)("div",{className:"error__text",children:"Ops, n\xe3o tem nada aqui."})]})},F=function(){var e=Object(s.c)((function(e){return e.searchQuery})).keyword;return e?Object(l.jsx)(W,{keyword:e}):Object(l.jsx)(J,{})};var B=function(){return Object(l.jsxs)(i.a,{basename:"/desafio-tmdb-infinitescroll-debounce-redux",children:[Object(l.jsx)(A,{}),Object(l.jsxs)(u.c,{children:[Object(l.jsx)(u.a,{path:"/",exact:!0,component:F}),Object(l.jsx)(u.a,{path:"/detail/:id",component:M})]}),Object(l.jsx)(d,{})]})},Y=a(17),Z=a(39),z=a(40),H=a(21),G=a(18),q=a(6),X=a(27),K=a.n(X),$={loading:!1,error:null,movies:[]},ee={loading:!1,error:null,movies:[]},te={loading:!1,error:null,cachedDetails:{}},ae=function(e){var t,a,r,n,o,c,s=[null===e||void 0===e||null===(t=e.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.errors],i=null===e||void 0===e||null===(r=e.response)||void 0===r||null===(n=r.data)||void 0===n?void 0:n.status_code;return{devMessage:{errors:s,statusCode:i,statusMessage:null===e||void 0===e||null===(o=e.response)||void 0===o||null===(c=o.data)||void 0===c?void 0:c.status_message},userMessage:s?"C\xf3digo: 422 - A consulta deve ser fornecida ou n\xe3o \xe9 v\xe1lida.":"C\xf3digo: ".concat(i," - ").concat({7:"Chave de API inv\xe1lida.",34:"O recurso solicitado n\xe3o p\xf4de ser encontrado."}[i])}},re={keyword:""},ne={},oe=Object(Y.combineReducers)({searchQuery:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:re,t=arguments.length>1?arguments[1]:void 0,a=t.type,r=t.payload;switch(a){case R:return{keyword:r};case C:return{keyword:""};default:return e}},moviePopular:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:$,t=arguments.length>1?arguments[1]:void 0,a=t.type,r=t.payload;switch(a){case f:return Object(q.a)(Object(q.a)({},e),{},{loading:!0});case _:return Object(q.a)(Object(q.a)({},e),{},{error:null,loading:!1,movies:K()([].concat(Object(G.a)(e.movies),Object(G.a)(r.results)),"id"),page:r.page,totalPages:r.total_pages,totalResults:r.total_results,hasMorePages:r.page<r.total_pages});case x:return{loading:!1,error:ae(r)};default:return e}},movieSearch:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ee,t=arguments.length>1?arguments[1]:void 0,a=t.type,r=t.payload;switch(a){case y:return Object(q.a)(Object(q.a)({},e),{},{loading:!0});case w:return r.keyword===e.keyword?{error:null,loading:!1,keyword:r.keyword,movies:K()([].concat(Object(G.a)(e.movies),Object(G.a)(r.results)),"id"),page:r.page,totalPages:r.total_pages,totalResults:r.total_results,hasMorePages:r.page<r.total_pages}:{error:null,loading:!1,keyword:r.keyword,movies:r.results,page:1,totalPages:r.total_pages,totalResults:r.total_results,hasMorePages:r.page<r.total_pages};case k:return{loading:!1,error:ae(r)};default:return e}},movieDetails:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:te,t=arguments.length>1?arguments[1]:void 0,a=t.type,r=t.payload;switch(a){case E:return Object(q.a)(Object(q.a)({},e),{},{loading:!0});case N:return{loading:!1,error:null,cachedDetails:Object(q.a)(Object(q.a)({},e.cachedDetails),{},Object(H.a)({},r.id,{id:r.id,title:r.title,tagline:r.tagline,originalLanguage:r.originalLanguage,originalTitle:r.originalTitle,overview:r.overview,popularity:r.popularity,backdropPath:r.backdropPath,posterPath:r.posterPath,releaseDate:r.releaseDate,genres:r.genres,voteAverage:r.voteAverage}))};case I:return{loading:!1,error:ae(r)};default:return e}}}),ce=[Z.a,function(){return function(e){return function(t){var a,r=null===(a=t.meta)||void 0===a?void 0:a.debounce;if(!r)return e(t);clearTimeout(ne[t.type]),ne[t.type]=setTimeout((function(){var a;null===(a=t.meta)||void 0===a||delete a.debounce,delete ne[t.type],e(t)}),r)}}}],se=Object(Y.createStore)(oe,{},Object(z.composeWithDevTools)(Y.applyMiddleware.apply(void 0,ce)));c.a.render(Object(l.jsx)(s.a,{store:se,children:Object(l.jsx)(B,{})}),document.getElementById("root"))}},[[75,1,2]]]);
//# sourceMappingURL=main.0de32d2d.chunk.js.map